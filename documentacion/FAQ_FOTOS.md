# â“ FAQ - Sistema de IdentificaciÃ³n de Fotos\n\n## Preguntas Frecuentes\n\n### P1: Â¿Por quÃ© la foto tiene ese nombre tan largo?\n**R:** El nombre largo garantiza unicidad y trazabilidad:\n- `instalacion`: Saber de dÃ³nde vino la foto\n- `tipo`: Saber cuÃ¡l foto es (principal, adicional 1, adicional 2)\n- `fecha_hora`: Saber cuÃ¡ndo se tomÃ³\n- `timestamp`: Garantizar que NUNCA hay duplicados\n\n### P2: Â¿QuÃ© pasa si tomo dos fotos al MISMO segundo?\n**R:** Los milisegundos (`1705759542000`) hace imposible que coincidan:\n```\n14:30:00.001 â†’ 1705759000001\n14:30:00.002 â†’ 1705759000002  â† Diferente\n```\n\n### P3: Â¿DÃ³nde se guardan las fotos?\n**R:** En `/app_documents/fotos_offline/` del dispositivo:\n```\n/data/data/com.lectra.app/app_documents/fotos_offline/\nâ”œâ”€â”€ A001_foto_2026-01-20_14-30-00_1705759000000.jpg\nâ”œâ”€â”€ A001_foto1_2026-01-20_14-30-10_1705759010000.jpg\nâ”œâ”€â”€ B002_foto_2026-01-20_14-31-00_1705759060000.jpg\nâ””â”€â”€ ...\n```\n\n### P4: Â¿Se eliminan las fotos antiguas automÃ¡ticamente?\n**R:** No en esta versiÃ³n, se acumulan. Futuro: implementar limpieza cada 30 dÃ­as.\n\n### P5: Â¿QuÃ© pasa si alguien borra una foto manualmente?\n**R:** El sistema lo detecta:\n```dart\nif (await _fotoFile!.exists()) {\n  // Usar la foto\n} else {\n  // Log: Foto no existe\n  // Usuario verÃ¡ vacÃ­o en la pantalla\n}\n```\n\n### P6: Â¿CÃ³mo recupero una foto eliminada?\n**R:** La ruta estÃ¡ guardada en OfflineSyncService, pero el archivo se perdiÃ³. Solo recuperable si:\n- Hiciste backup de `/fotos_offline/` antes\n- Sincronizaste con servidor (prÃ³xima versiÃ³n)\n\n### P7: Â¿Se pueden confundir fotos de dos instalaciones?\n**R:** NO, es imposible:\n```\nInstalaciÃ³n A001:\n  Foto siempre tiene \"A001\" en el nombre\n  \nInstalaciÃ³n B002:\n  Foto siempre tiene \"B002\" en el nombre\n  \nEn PDF:\n  Se valida: Â¿Contiene el nombre de la instalaciÃ³n actual?\n  Si NO â†’ Se muestra advertencia en logs\n```\n\n### P8: Â¿QuÃ© sucede si me quedo sin espacio en el dispositivo?\n**R:** La foto no se guardarÃ¡:\n```\nğŸ’¾ Foto guardada en: ...\nâŒ Error guardando foto: No space left on device\n```\nUsuario verÃ¡ error, la foto no se cargarÃ¡.\n\n### P9: Â¿Las fotos se sincronizan con el servidor?\n**R:** AÃºn no en esta versiÃ³n. Se guardan solo offline. Futuro: sincronizaciÃ³n automÃ¡tica.\n\n### P10: Â¿Puedo editar una foto despuÃ©s de guardarla?\n**R:** SÃ­, al volver a abrir el registro:\n1. Toma una foto nueva (se guarda con nuevo timestamp)\n2. Al generar PDF, usarÃ¡ la mÃ¡s reciente\n3. La anterior sigue guardada pero no se usa\n\n---\n\n## ğŸ”§ SoluciÃ³n de Problemas\n\n### Problema 1: Fotos se siguen mezclando\n**SÃ­ntomas:**\n- PDF de A001 tiene foto de B002\n- Logs no muestran validaciÃ³n\n\n**SoluciÃ³n:**\n1. [ ] Verifica que estÃ©s usando la versiÃ³n actualizada\n2. [ ] Borra cachÃ©: `Ajustes > Lectra > Almacenamiento > Limpiar cachÃ©`\n3. [ ] Reinicia la app\n4. [ ] Prueba nuevamente\n\n**Si persiste:**\n```bash\n# Ver directorio de fotos\nadb shell ls /data/data/com.lectra.app/app_documents/fotos_offline/\n\n# Ver nombres de archivos\nadb shell find /data/data/com.lectra.app/app_documents -name \"*.jpg\"\n```\n\n---\n\n### Problema 2: No carga la foto anterior\n**SÃ­ntomas:**\n- Abro un registro, la foto no estÃ¡\n- Pero sÃ© que la guardÃ©\n\n**SoluciÃ³n:**\n1. [ ] Busca en logs: `Error cargando foto`\n2. [ ] Verifica archivo existe:\n   ```bash\n   adb shell test -f /path/to/foto && echo \"Existe\" || echo \"No existe\"\n   ```\n3. [ ] Si no existe: fue borrada o dispositivo sincronizÃ³\n4. [ ] Toma la foto nuevamente\n\n---\n\n### Problema 3: PDF no incluye fotos\n**SÃ­ntomas:**\n- PDF se genera pero sin imÃ¡genes\n- O con la foto equivocada\n\n**SoluciÃ³n:**\n1. [ ] Busca en logs antes de generar PDF:\n   ```\n   âœ… Foto ... validada para instalaciÃ³n:\n   ```\n2. [ ] Si ves `ADVERTENCIA: Foto NO pertenece`:\n   - La foto tiene nombre de otra instalaciÃ³n\n   - Causa: Metadata corrupta o manual copy\n3. [ ] SoluciÃ³n: Tomar foto nuevamente\n\n---\n\n### Problema 4: Crashes al generar PDF\n**SÃ­ntomas:**\n- App cierra cuando hago clic en \"Generar PDF\"\n- Error: \"IOException\" o similar\n\n**SoluciÃ³n:**\n1. [ ] Verifica espacio disponible:\n   - Ajustes > Almacenamiento > Espacio disponible\n   - Debe haber al menos 100MB libres\n2. [ ] Libera espacio y reinicia\n3. [ ] Intenta nuevamente\n\n---\n\n### Problema 5: Metadata corrupta\n**SÃ­ntomas:**\n- Logs muestran nombres extraÃ±os en metadata\n- ValidaciÃ³n falla\n\n**SoluciÃ³n:**\n1. [ ] Borra la inconsistencia (perd los datos offline)\n2. [ ] Sincroniza con servidor\n3. [ ] Abre nuevamente la inconsistencia\n4. [ ] Toma fotos nuevamente\n\n---\n\n## ğŸ“‹ Checklist de SoluciÃ³n de Problemas\n\nAntes de reportar un bug:\n\n- [ ] Â¿Reiniciaste la app?\n- [ ] Â¿Limpiaste cachÃ© de la app?\n- [ ] Â¿El dispositivo tiene espacio disponible?\n- [ ] Â¿QuÃ© instalaciÃ³n es? (A001, B002, etc)\n- [ ] Â¿CuÃ¡l fue la Ãºltima acciÃ³n que hiciste?\n- [ ] Â¿Ves los logs de validaciÃ³n de fotos?\n- [ ] Â¿Existe el archivo en el directorio?\n\n---\n\n## ğŸ” CÃ³mo Reportar un Bug\n\nSi despuÃ©s de lo anterior aÃºn hay problema, reporta con:\n\n1. **DescripciÃ³n**: QuÃ© pasÃ³ exactamente\n2. **Pasos**: CÃ³mo reproducir el problema\n3. **Logs**: Copiar lÃ­neas relevantes de:\n   ```\n   ğŸ“· Foto guardada...\n   âœ… Foto validada...\n   âš ï¸ ADVERTENCIA...\n   âŒ Error...\n   ```\n4. **InstalaciÃ³n**: CuÃ¡les instalaciones estaban involucradas\n5. **Dispositivo**: Modelo, versiÃ³n Android, espacio disponible\n6. **VersiÃ³n**: QuÃ© versiÃ³n de Lectra estabas usando\n\n---\n\n## ğŸš€ Tips Avanzados\n\n### Ver todas las fotos de una instalaciÃ³n\n```bash\n# Conectar con adb\nadb shell\n\n# Listar fotos de instalaciÃ³n A001\nls /data/data/com.lectra.app/app_documents/fotos_offline/ | grep A001\n\n# Contar fotos totales\nls -1 /data/data/com.lectra.app/app_documents/fotos_offline/ | wc -l\n```\n\n### Ver tamaÃ±o total de fotos\n```bash\ndu -sh /data/data/com.lectra.app/app_documents/fotos_offline/\n```\n\n### Extraer una foto para ver\n```bash\n# Pull a tu computadora\nadb pull /data/data/com.lectra.app/app_documents/fotos_offline/A001_foto_*.jpg ./\n\n# Ver con visor de imÃ¡genes\nopen *.jpg\n```\n\n### Limpiar fotos de una instalaciÃ³n (CUIDADO)\n```bash\n# NO hacer esto sin backup!\nadb shell rm /data/data/com.lectra.app/app_documents/fotos_offline/A001_*\n```\n\n---\n\n## ğŸ“ Contacto para Soporte\n\nSi el problema persiste despuÃ©s de:\n1. Limpiar cachÃ©\n2. Reiniciar app\n3. Liberar espacio\n4. Revisar logs\n\nContacta a: `soporte@lectra.com` con los datos del bug.\n"